<app-carrusel-principal></app-carrusel-principal>



<!-- Categorias -->
<section class="container-fluid  my-5 px-md-4">
  <h1 class="fs-2 mb-4">Encuentra lo que buscas</h1>

  <div class="categoria-wrapper">
    <!-- Categorías dinámicas desde la base de datos -->
    <div class="promo-rect-card align-items-center " 
         *ngFor="let categoria of categorias" 
         [routerLink]="getCategoriaRoute(categoria)">
      <div class="categoria-img-wrapper">
        <img [src]="categoria.imagen_url || 'imagenes/categorias/default.webp'" 
             loading="lazy" 
             [alt]="categoria.nombre" 
             class="img-fluid full-image">
      </div>
    </div>

    
  </div>
</section>




<section class="container-fluid px-md-5">
  <h2 class="mb-4">Lo Más Vendido</h2>
  
  <!-- Loading state -->
  <div *ngIf="loading.masVendido" class="text-center">
    <div class="spinner-border" role="status">
      <span class="visually-hidden">Cargando productos más vendidos...</span>
    </div>
  </div>
  
  <!-- Productos más vendidos - ACTUALIZADO CON CATEGORÍAS -->
  <peruvians-carrusel-productos 
    *ngIf="masVendido?.length && !loading.masVendido"
    [productos]="masVendido" 
    [carouselId]="'ProductosCarrusel1'"
    [categoriasJerarquicas]="categoriasJerarquicas">
  </peruvians-carrusel-productos>

  <!-- Estado vacío -->
  <div *ngIf="!masVendido?.length && !loading.masVendido" class="alert alert-info">
    No hay productos más vendidos disponibles en este momento.
  </div>
</section>

<section class="container-fluid px-md-5">
  <h2 class="mb-4">Lo Más Nuevo</h2>
  
  <!-- Loading state -->
  <div *ngIf="loading.masNuevo" class="text-center">
    <div class="spinner-border" role="status">
      <span class="visually-hidden">Cargando productos más nuevos...</span>
    </div>
  </div>
  
  <!-- Productos más nuevos - ACTUALIZADO CON CATEGORÍAS -->
  <peruvians-carrusel-productos 
    *ngIf="masNuevo?.length && !loading.masNuevo"
    [productos]="masNuevo" 
    [carouselId]="'ProductosCarrusel2'"
    [categoriasJerarquicas]="categoriasJerarquicas">
  </peruvians-carrusel-productos>

  <!-- Estado vacío -->
  <div *ngIf="!masNuevo?.length && !loading.masNuevo" class="alert alert-info">
    No hay productos nuevos disponibles en este momento.
  </div>
</section>

<!-- CyberWow Section - Ahora dinámica -->
<section class="container-fluid px-md-5 my-5" *ngIf="(cyberwowBanners.categoria || cyberwowBanners.tiendas || cyberwowBanners.productos.length > 0) && !loading.cyberwow">
  <h2 class="mb-4">CyberWow</h2>
  
  <!-- Fila 1: Banners principales (categoría y tiendas) -->
  <div class="row gy-4" *ngIf="cyberwowBanners.categoria || cyberwowBanners.tiendas"> 
    <!-- Banner de categoría -->
    <div class="col-12 col-md-6 promo-card position-relative overflow-hidden rounded-3" 
         *ngIf="cyberwowBanners.categoria"
         [routerLink]="getCyberwowCategoriaRoute()">
      <img [src]="cyberwowBanners.categoria.imagen_url" 
           loading="lazy" 
           width="100%" 
           class="promo-img rounded-3" 
           [alt]="cyberwowBanners.categoria.titulo">
      <button class="btn btn-success promo-btn">¡Lo quiero!</button>
    </div>
    
    <!-- Banner de tiendas -->
    <div class="col-12 col-md-6 promo-card position-relative overflow-hidden rounded-3"
        *ngIf="cyberwowBanners.tiendas"
        (click)="onCyberwowTiendasClick()"
        style="cursor: pointer;">
      <img [src]="cyberwowBanners.tiendas.imagen_url" 
          loading="lazy" 
          width="100%" 
          class="promo-img rounded-3" 
          [alt]="cyberwowBanners.tiendas.titulo">
      <button class="btn btn-success promo-btn">¡Lo quiero!</button>
    </div>
  </div>

  <!-- Fila 2: Banners de productos -->
  <div class="row my-4" *ngIf="cyberwowBanners.productos.length > 0">
    <div class="col-6 col-md-3 promo-card position-relative overflow-hidden rounded-3 my-2"
         *ngFor="let banner of cyberwowBanners.productos"
         [routerLink]="getCyberwowProductoRoute(banner)">
      <img [src]="banner.imagen_url" 
           loading="lazy" 
           width="100%" 
           class="promo-img rounded-3" 
           [alt]="banner.titulo">
      <button class="btn btn-success promo-btn">¡Lo quiero!</button>
    </div>
  </div>
</section>

<!-- Loading state para CyberWow -->
<section class="container my-5" *ngIf="loading.cyberwow">
  <h2 class="mb-4">CyberWow</h2>
  <div class="text-center">
    <div class="spinner-border" role="status">
      <span class="visually-hidden">Cargando ofertas CyberWow...</span>
    </div>
  </div>
</section>


<section class="container-fluid my-5 px-md-4">
  <h2 class="mb-4">Nuestras Categorias</h2>
  
  <div *ngIf="loading.liquidacion" class="text-center">
    <div class="spinner-border" role="status">
      <span class="visually-hidden">Cargando productos en liquidación...</span>
    </div>
  </div>

  <!-- Contenido de liquidaciones - CORREGIDO -->
  <div class="row   gy-2 gap-md-3 gap-0"*ngIf="liquidacion?.length && !loading.liquidacion">
    <div class="promo-rect-card align-items-center col-md-3 col-6" 
         *ngFor="let item of liquidacion" 
         (click)="navegarAProducto(item.producto)">
        <!-- Imagen de liquidación -->
        <div class=" contenedor-img-liquidacion" >
          <img [src]="item.imagen_url || item.producto.img || 'imagenes/default.webp'" 
               [alt]="item.producto.nombre" 
               class="img-fluid full-image"
               loading="lazy" />
      </div>
    </div>
  </div>

  <!-- Estado vacío -->
  <div *ngIf="!liquidacion?.length && !loading.liquidacion" class="alert alert-info">
    No hay productos en liquidación disponibles en este momento.
  </div>
</section>




<!-- Tiendas -->
<section class="container-fluid px-md-5 my-5">
  <h2 class="mb-4">Nuestras Tiendas</h2>

  <div class="scroll">
    <div class="scroll-track">

        <div class="carrusel-item">
          <img src="logos/3boutique.jpg" loading="lazy" alt="Vitaminas" class="categoria-img img-fluid">
          
        </div>

        <div class="carrusel-item">
          <img src="logos/alestore.jpg" loading="lazy" alt="Suplementos" class="categoria-img img-fluid">
          
        </div>

        <div class="carrusel-item">
          <img src="logos/franstore.jpg" loading="lazy" alt="Abarrotes" class="categoria-img img-fluid">
        </div>
        <div class="carrusel-item">
          <img src="logos/gomugomix.webp" loading="lazy" alt="gomugomix" class="categoria-img img-fluid bg-white">
        </div>
        <div class="carrusel-item">
          <img src="logos/kastroperu.jpg" loading="lazy" alt="Frescos" class="categoria-img img-fluid">
        </div>

        <div class="carrusel-item">
          <img src="logos/mymstore.jpg" loading="lazy" alt="Congelados" class="categoria-img img-fluid">
        </div>
        
        <div class="carrusel-item">
          <img src="logos/quickstore.jpg"loading="lazy" alt="Congelados" class="categoria-img img-fluid">
        </div>

        <div class="carrusel-item">
          <img src="logos/vicstore.jpg" loading="lazy" alt="Congelados" class="categoria-img img-fluid">
        </div>

        <div class="carrusel-item">
          <img src="logos/lukin4.webp" loading="lazy" alt="lukin4" class="categoria-img img-fluid bg-white">
        </div>

        <!-- Duplicados para efecto infinito -->
           <div class="carrusel-item">
          <img src="logos/3boutique.jpg" loading="lazy" alt="Vitaminas" class="categoria-img img-fluid">
        </div>

        <div class="carrusel-item">
          <img src="logos/alestore.jpg" loading="lazy" alt="Suplementos" class="categoria-img img-fluid">
        </div>

        <div class="carrusel-item">
          <img src="logos/franstore.jpg" loading="lazy" alt="Abarrotes" class="categoria-img img-fluid">
        </div>
        <div class="carrusel-item">
          <img src="logos/gomugomix.webp" loading="lazy" alt="gomugomix" class="categoria-img img-fluid bg-white">
        </div>
        <div class="carrusel-item">
          <img src="logos/kastroperu.jpg" loading="lazy" alt="Frescos" class="categoria-img img-fluid">
        </div>

        <div class="carrusel-item">
          <img src="logos/mymstore.jpg" loading="lazy" alt="Congelados" class="categoria-img img-fluid">
        </div>
        
        <div class="carrusel-item">
          <img src="logos/quickstore.jpg"loading="lazy" alt="Congelados" class="categoria-img img-fluid">
        </div>

        <div class="carrusel-item">
          <img src="logos/vicstore.jpg" loading="lazy" alt="Congelados" class="categoria-img img-fluid">
        </div>

        <div class="carrusel-item">
          <img src="logos/lukin4.webp" loading="lazy" alt="lukin4" class="categoria-img img-fluid bg-white">
        </div>
    </div>
</div>
</section>

<section class="container-fluid px-md-5 ">
  <h2 class="mb-4">Testimonios</h2>
  <peruvians-carrusel-comentarios></peruvians-carrusel-comentarios>
</section>


<app-modal-emergente></app-modal-emergente>
