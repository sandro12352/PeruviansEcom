<div class="container my-5 ">
  <!-- Encabezado -->
  <div class="d-flex align-items-center gap-3 mb-5">
    <img role="button" routerLink="/" src="logo.png" alt="peruvian-ecom" class="img-fluid" width="170" height="80">
    <div> 
        <h1 class="fw-bold m-0 p-0 fs-3">CARRITO DE COMPRAS</h1>
        <a routerLink="/">Volver</a>
    </div>
  
  </div>

  <!-- Carrito con productos -->
  <div *ngIf="productos.length > 0; else carritoVacio">
    <div class="row gy-4">
      
      <!-- Lista de productos -->
     <!-- Lista de productos -->
<div class="col-md-8 col-12">
  <div *ngFor="let producto of productos" class="card shadow-sm border-1 rounded-4 p-3 mb-3">
    <div class="d-flex gap-3">
      
      <!-- Imagen -->
      <div style="width: 100px; height: 100px; flex-shrink: 0;">
        <img [src]="producto.img" alt="{{ producto.titulo }}" class="img-fluid rounded-3 h-100 w-100" style="object-fit: cover;">
      </div>

      <!-- Contenido -->
      <div class="flex-grow-1 d-flex flex-column justify-content-between">

        <!-- Cabecera: título, tienda, tachito -->
        <div class="d-flex justify-content-between align-items-start">
          <div>
            <h5 class="mb-1">{{ producto.titulo }}</h5>
            <small class="text-muted">{{ producto.tienda }}</small>
          </div>
          
          <!-- Botón eliminar -->
          <button class="btn btn-sm p-0 bg-transparent border-0" (click)="eliminarProducto(producto)" aria-label="Eliminar producto">
            <i class="bi bi-trash3-fill fs-5 text-danger"></i>
          </button>
        </div>
        <!-- Precio -->
        <div class="d-flex  align-items-center gap-2">
          <s class="text-muted">S/ {{ producto.precio | number:'1.2-2' }}</s>
          <span class="fw-semibold text-danger">S/ {{ producto.precio_despues | number:'1.2-2' }}</span>
        </div>
        <!-- Cantidad -->
        <div class="my-2">
          <div class="cantidad-box d-flex align-items-center justify-content-between ">
                    <button class="cantidad-btn" type="number" [value]="producto.cantidad" min="1"  
                    (click)="disminuirCantidad(producto)">−</button>
                    <span>{{ producto.cantidad }}</span>
                    <button class="cantidad-btn" (click)="aumentarCantidad(producto)">+</button>
          </div>
        </div>
      </div>
      
    </div>
  </div>

   <div class="container card shadow-sm border-1 rounded-4 p-3 mb-3">
  <h5 class="text-dark fw-bold mt-3">Entrega</h5>

  <div class="row justify-content-center mt-3">
    <!-- Botones estilo tabs -->
    <div class="nav nav-pills d-flex flex-wrap gap-2 justify-content-center p-2" id="entregaTabs" role="tablist">
      <button 
        class="btn btn-outline-success active d-flex align-items-center justify-content-center gap-2 flex-fill"
        id="btn-domicilio"
        data-bs-toggle="pill"
        data-bs-target="#contenido1"
        type="button"
        role="tab"
        (click)="seleccionarEntrega('domicilio')">
        <img src="https://cdn-icons-png.flaticon.com/512/3854/3854968.png" width="25" height="25" alt="Domicilio">
        <span class="text-nowrap">Entrega a domicilio (Lima o Callao)</span>
      </button>

      <button 
        class="btn btn-outline-success d-flex align-items-center justify-content-center gap-2 flex-fill"
        id="btn-agencia"
        data-bs-toggle="pill"
        data-bs-target="#contenido2"
        type="button"
        role="tab"
        (click)="seleccionarEntrega('agencia')">
        <span class="text-nowrap">Entrega por agencia (Provincia)</span>    
      </button>
    </div>
  </div>

  <!-- Contenido de tabs -->
  <div class="tab-content mt-3">
    <div class="tab-pane fade show active" id="contenido1" role="tabpanel">
      <div class="card card-body text-center">
        <span class="fw-semibold">Regular</span>
        <span class="text-muted fs-6">En hasta 24 horas hábiles</span>
      </div>
    </div>

    <div class="tab-pane fade" id="contenido2" role="tabpanel">
      <div class="card card-body text-center">
        <span class="fw-semibold">Regular</span>
        <span class="text-muted fs-6">En hasta 3 días hábiles</span>
      </div>
    </div>
  </div>
  </div>


</div>


      <!-- Resumen -->
      <div class="col-md-4 col-12">
        <div class="card shadow-sm border-0 rounded-4 p-4 bg-light">
          <h4 class="mb-4">Resumen</h4>
          <div class="d-flex justify-content-between mb-2">
            <span>Subtotal</span>
            <span>S/ {{ calcularSubtotal() | number:'1.2-2' }}</span>
           
          </div>
           
          <hr>
          <div class="d-flex justify-content-between mb-2">
              <span>Descuento</span>
            <span>-S/ {{ calcularDescuento() | number:'1.2-2' }}</span>
          </div>
          <div class="d-flex justify-content-between mb-4">
            <strong>Total</strong>
            <strong>S/ {{ calcularTotal() | number:'1.2-2'  }}</strong>
          </div>
          <div class="d-flex flex-column gap-2 align-items-center">
              <button routerLink="/checkout/pagar" class="btn btn-pagar  w-100 rounded-3">Ir a Pagar</button>
              <a routerLink="/">seguir comprando</a>
          </div>
       
        </div>
      </div>
    </div>
  </div>

 

  <!-- Carrito vacío -->
  <ng-template #carritoVacio>
    <div class="text-center mt-5">
      <i class="bi bi-cart-x fs-1 text-muted"></i>
      <p class="mt-3 fs-5">Tu carrito está vacío.</p>
    </div>
  </ng-template>
</div>
